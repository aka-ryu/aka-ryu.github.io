---
layout: post
title: CS - DNS 라이프사이클
category: CS
---
# DNS 요청의 라이프사이클 정리

---

## ✅ DNS 라이프사이클이란?

> 우리가 브라우저에 `www.example.com` 이런 주소를 입력했을 때,
> 실제로 어떤 경로를 거쳐서 IP 주소로 연결되는지를 나타낸 흐름이었다.

즉, 도메인을 IP로 바꾸는 전 과정의 단계별 흐름이다.

---

## 🔄 전체 흐름 한 줄 요약

```text
브라우저 → OS 캐시 → 로컬 DNS → 루트 DNS → TLD DNS → 권한 DNS → 응답 받음
```

---

## 📍 순서대로 단계 설명

### 1. 브라우저 캐시 확인

* 브라우저 내부에 과거 접속했던 도메인-IP가 저장돼 있다면 바로 사용했다

### 2. OS 캐시 확인

* 브라우저에 없으면 OS 차원의 DNS 캐시(dnsmasq, Windows DNS 등) 확인했다

### 3. 로컬 DNS 서버 요청

* 로컬 네트워크나 ISP에서 제공하는 DNS 서버에 요청했다
* 여기도 없으면 본격적으로 DNS 탐색 시작된다

### 4. 루트 DNS 서버 요청

* 최상위 루트 DNS 서버(13개 전 세계 운영)에게 `.com` 같은 TLD 서버 주소를 물어본다

### 5. TLD DNS 서버 요청

* `.com` TLD DNS가 `example.com`을 관리하는 권한 DNS 주소를 알려준다

### 6. 권한 DNS 서버 요청 (Authoritative)

* 진짜 최종 IP를 알고 있는 서버에게 IP를 요청한다
* 여기서 진짜 `www.example.com = 93.184.216.34` 같은 값이 나온다

### 7. 결과 캐싱

* 응답 결과는 TTL(Time To Live) 기준으로 브라우저, OS, 로컬 DNS가 전부 캐싱해둔다
* 다음 요청부터는 이 캐시 덕분에 빠르게 응답된다

---

## ⏱ TTL(Time To Live)이란?

* DNS 결과(IP)가 **얼마나 오래 캐시에 저장될지 정하는 값**이었다
* 예: TTL=3600이면 → 1시간 동안은 캐시된 IP로 바로 응답 가능했다

---

## 🧪 실제 예시 흐름

```
1. 브라우저: 캐시 없음
2. OS: 캐시 없음
3. 로컬 DNS: 캐시 없음
4. 루트 DNS → .com 알려줌
5. .com TLD → example.com의 NS 알려줌
6. NS → www.example.com = 93.184.216.34 리턴
7. 이걸로 웹사이트 접속 시작됨
```

---

## ✅ 요약표

| 단계      | 설명                         |
| ------- | -------------------------- |
| 브라우저 캐시 | 가장 빠른 응답, 과거 방문 이력 기반      |
| OS 캐시   | OS 시스템 DNS 캐시 사용           |
| 로컬 DNS  | ISP 또는 회사 DNS 서버, 자체 캐시 있음 |
| 루트 DNS  | .com, .net 같은 TLD 위치 알려줌   |
| TLD DNS | 특정 도메인의 네임서버 주소 알려줌        |
| 권한 DNS  | 최종 IP 주소를 알고 있는 진짜 주인 서버   |
| TTL     | 캐시 유지 시간 (초 단위)            |

---

## 🎯 정리

* 브라우저에서 도메인을 입력하면 IP를 찾기 위해 여러 단계 거쳤다
* 대부분은 캐시 덕분에 루트까지 안 가고 **중간에서 끝나기도 한다**
* TTL 덕분에 중복 요청을 줄이고 성능도 좋아졌다

> 즉, DNS 요청은 처음엔 귀찮지만, 한번 찾고 나면 캐시 덕분에 아주 빠르게 작동되었다.
