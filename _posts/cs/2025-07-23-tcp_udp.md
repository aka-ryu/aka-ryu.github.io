---
layout: post
title: CS - TCP/UDP
category: CS
---
## TCP vs UDP 정리해봤다

네트워크 통신에서 자주 나오는 TCP와 UDP.
서로 어떻게 다른지, 언제 뭘 써야 하는지, 또 실제 환경에서 어떻게 설정하는지도 포함해서 정리했다.

---

## ✅ TCP (Transmission Control Protocol)

> 신뢰성 있는 통신을 원할 때 쓰는 프로토콜이다.

### 특징

* 3-way Handshake를 통해 먼저 연결 맺고 데이터 전송 시작
* 순서 보장, 데이터 유실 시 재전송
* 수신 확인(ACK) 있음

### 장점

* 데이터가 정확하고 순서대로 도착함
* 신뢰성이 높음

### 단점

* 연결, 재전송, 확인 등으로 속도가 느릴 수 있음

### 사용 예시

* 웹사이트 접속 (HTTP/HTTPS)
* 이메일 송수신 (SMTP, IMAP)
* 파일 다운로드 서비스

---

## ✅ UDP (User Datagram Protocol)

> 빠르게 보내는 데 집중하는 통신 방식. 신뢰성은 낮지만 속도가 중요할 때 쓴다.

### 특징

* 연결 없이 그냥 데이터 전송함 (비연결 지향)
* 순서 보장 없음, 유실되면 재전송도 없음
* 오버헤드 거의 없음

### 장점

* 빠르다
* 실시간에 유리하다

### 단점

* 데이터 손실, 순서 뒤섞임 가능
* 신뢰성이 낮음

### 사용 예시

* 영상/음성 스트리밍 (Zoom, Skype)
* 온라인 게임 서버 통신
* DNS 질의 응답

---

## ✅ 비교 요약

| 항목       | TCP             | UDP             |
| -------- | --------------- | --------------- |
| 연결 방식    | 연결 필요           | 연결 없음           |
| 속도       | 느림              | 빠름              |
| 신뢰성      | 높음              | 낮음              |
| 순서 보장    | O               | X               |
| 데이터 유실 시 | 재전송             | 무시              |
| 사용 예시    | HTTP, 이메일, 파일전송 | 게임, 실시간 통신, DNS |

---

## ✅ 선택 기준

| 상황        | 추천 프로토콜 | 이유                   |
| --------- | ------- | -------------------- |
| 웹, API 서버 | TCP     | 정확하고 순서대로 처리돼야 함     |
| 게임, 음성통화  | UDP     | 빠른 응답이 중요, 유실 허용     |
| 실시간 스트리밍  | UDP     | 속도 우선, 끊기면 다시 보내지 않음 |

---

## ✅ 그럼 TCP/UDP는 어디서 설정하냐?

프로토콜 자체를 코드에서 고르기도 하고, 인프라 구성에서도 선택해야 하는 경우가 있다.

### 1. 애플리케이션 코드에서 직접 지정

```js
// TCP 서버 예시 (Node.js)
const net = require('net');
const server = net.createServer((socket) => {
  socket.write('Hello TCP');
});
server.listen(3000);
```

```js
// UDP 서버 예시 (Node.js)
const dgram = require('dgram');
const server = dgram.createSocket('udp4');
server.on('message', (msg, rinfo) => {
  console.log(`UDP 메시지: ${msg}`);
});
server.bind(41234);
```

---

### 2. AWS EC2 보안 그룹 설정에서

| 항목                  | 예                     |
| ------------------- | --------------------- |
| TCP 포트 80 (HTTP) 허용 | Inbound Rule: TCP, 80 |
| UDP 포트 53 (DNS) 허용  | Inbound Rule: UDP, 53 |

설정 위치: EC2 > 보안 그룹 > 인바운드/아웃바운드 규칙 > 프로토콜 선택

---

### 3. AWS 로드밸런서에서

| 로드밸런서 타입 | 지원 프로토콜                 | 설정 위치               |
| -------- | ----------------------- | ------------------- |
| ALB      | HTTP, HTTPS (내부적으로 TCP) | 리스너에서 HTTP/HTTPS 선택 |
| NLB      | TCP, UDP                | 리스너에서 TCP/UDP 선택    |

예: NLB 리스너 → TCP:443, UDP:1194 같은 식으로 지정 가능

---

### 4. 방화벽/라우터/공유기 등 장비에서

* 포트포워딩 설정 시 TCP/UDP 중 어떤 걸 열지 지정함

---

### 5. 프로토콜 자체가 정해진 경우

* HTTP → TCP 기반
* HTTP/3 → UDP 기반 (QUIC)
* WebRTC → UDP 기반

개발자가 별도로 설정 안 해도 프로토콜을 선택함에 따라 결정됨

---

## ✅ 설정 위치 요약

| 설정 위치    | TCP/UDP 설정 방식                          |
| -------- | -------------------------------------- |
| 서버 코드    | net / dgram 등으로 직접 설정                  |
| 보안 그룹    | 인바운드/아웃바운드에서 TCP or UDP 선택             |
| 로드밸런서    | 리스너에서 프로토콜 선택 (HTTP, TCP, UDP)         |
| 공유기/방화벽  | 포트포워딩 시 TCP/UDP 명시                     |
| 사용 라이브러리 | 기본 프로토콜 따라감 (HTTP는 TCP, WebRTC는 UDP 등) |

---

TCP는 정확성, UDP는 속도.
내 서비스가 어떤 걸 더 중요시하는지 보고 고르면 된다.
