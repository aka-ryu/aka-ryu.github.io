---
layout: post
title: AWS - ASG 오토스케일링 그룹
categories: AWS
---

## AWS ASG (오토스케일링 그룹)

ASG는 EC2 인스턴스를 자동으로 늘리거나 줄여주는 AWS 서비스임. 트래픽이 많아지거나 줄어들 때, 내가 직접 서버 수를 조정하지 않아도 되게 해줌. 고가용성과 비용 절감에 아주 유리함.

---

### 1. 기본 구성 요소

#### ✅ Launch Template (또는 Launch Configuration)

* EC2를 만들 때 참고하는 설정 정보.
* AMI, 인스턴스 타입, 보안 그룹, 키페어 등 포함.
* 요즘은 Launch Configuration보다 Launch Template을 쓰는 게 일반적.

#### ✅ Auto Scaling Group (ASG)

* 이게 핵심임. 인스턴스를 그룹으로 묶어두고 최소/최대/원하는 인스턴스 수를 정해놓음.
* 예: 최소 2개, 최대 6개, 기본 3개 이런 식.

#### ✅ Scaling Policy

* 언제 인스턴스를 늘릴지/줄일지 정하는 규칙.
* 예: CPU가 70% 넘으면 1대 추가.

#### ✅ CloudWatch Alarm

* CPU 사용률 같은 걸 계속 감시함.
* 특정 조건 넘으면 Scaling Policy 트리거함.

#### ✅ Load Balancer + Target Group (옵션이지만 보통 같이 씀)

* ASG에서 만든 인스턴스들이 자동으로 로드밸런서에 연결됨.
* 트래픽 분산용.

---

### 2. 작동 흐름 요약

1. ASG 만들 때 최소/최대/원하는 수 정하고 Launch Template 연결함.
2. CloudWatch가 모니터링 중.
3. 예: CPU 80% 넘음 → CloudWatch 알람 발생.
4. Scaling Policy 작동 → 인스턴스 추가.
5. 새로운 인스턴스가 Target Group/로드밸런서에 자동 등록됨.

---

### 3. 스케일링 방식

* **동적 스케일링:** 실시간 데이터 기준 자동으로 증감.
* **예측 스케일링:** 과거 데이터를 보고 예상해서 조절.
* **수동 스케일링:** 사람이 직접 Desired 개수 바꾸는 것.

---

### 4. 헬스 체크 & 자동 교체

* 인스턴스가 죽었거나 문제 생기면 ASG가 자동으로 새로 띄움.
* EC2 상태 이상 or ELB 상태 이상도 대응 가능.

---

### 5. 장점 정리

| 항목    | 설명                         |
| ----- | -------------------------- |
| 고가용성  | 장애 시 자동 복구 가능              |
| 비용 절감 | 트래픽 줄면 자동으로 서버 줄임          |
| 자동화   | 거의 손 안 대고도 운영 가능           |
| 연동성   | ELB, CloudWatch랑 자연스럽게 연동됨 |

---

### 6. 예시 JSON (CloudFormation 일부)

```jsonc
"AutoScalingGroup": {
  "Type": "AWS::AutoScaling::AutoScalingGroup",
  "Properties": {
    "MinSize": "2",
    "MaxSize": "5",
    "DesiredCapacity": "3",
    "LaunchTemplate": {
      "LaunchTemplateName": "MyAppTemplate",
      "Version": "$Latest"
    },
    "TargetGroupARNs": ["..."],
    "VPCZoneIdentifier": ["subnet-aaa", "subnet-bbb"]
  }
}
```

---

필요하면 NestJS/Next.js 기반 서버를 ASG에 태우는 배포 구조도 따로 정리 가능함.
